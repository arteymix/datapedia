<!DOCTYPE html>
<html>
    <head>
        {% block head %}
            <title>{% block title %}Datapedia{% endblock %}</title>
            <meta name="description" content="{% block description %}Datapedia, the Wikipedia of data.{% endblock %}"/>
            <meta name="keywords" content="{% block keywords %}data{% endblock %}"/>
            {% block css %}
                <link rel="stylesheet" href="{{ url_for('static', filename = 'css/bootstrap.min.css') }}">
                <link rel="stylesheet" href="{{ url_for('static', filename = 'css/bootstrap-theme.min.css') }}">
            {% endblock %}
            <script type="application/javascript" src="{{ url_for('static', filename = 'js/jquery.min.js') }}"></script>
            <script type="application/javascript" src="{{ url_for('static', filename = 'js/bootstrap.min.js') }}"></script>
        {% endblock %}
    </head>
    <body>
        <header>
            {% block header %}
                <div class="container">
                    <div class="row">
                    <div class="col-xs-12">
                        <h1><a href="/">Datapedia</a></h1>
                        <p>Welcome to Datapedia, the <a href="http://wikipedia.org">Wikipedia</a> of data!</p>
                        <p>Search use <a href="http://docs.python.org/3.3/library/fnmatch.html#module-fnmatch">fnmatch syntax</a> for searches with a limit of 10 results.</p>
                        <form action="{{ url_for('datapedia') }}">
                            <input type="search" name="search" value="{{ search }}"/>
                            <button type="submit">Search</button>
                        </form>
                    </div>
                    </div>
                </div>
            {% endblock %}
        </header>
        <div class="container">
            {% block content %}
                <section class="row">
                    <div class="col-xs-12">
                        <h2>Results for {{ search }}</h2>
                        <ul>
                            {% for name, ext in results %}
                                <li>
                                    <a href="{{ url_for('current', name = name) }}">{{ name }}</a>
                                    (<a href="{{ url_for('current_raw', name = name, ext = ext) }}">{{ ext }}</a>)
                                </li>
                            {% else %}
                                <li><a href="{{ url_for('data', name = search) }}">Create {{ search }}</a></li>
                            {% endfor %}
                        </ul>
                    <div>
                </section>
                
                <section class="row">
                    <div class="col-xs-12">
                        <h2>How it works!</h2>
                        <ol>
                            <li>Data is requested from an endpoint with a name and a format</li> 
                            <li>We check if the data exists in the requested format</li>
                            <li>If it exists, it is returned else it checks if the name exists in other format</li>
                            <li>If it exists in another format, it is converted, cached and returned</li>
                            <li>Otherwise, an error message is returned in the requested format along with a 404 HTTP code</li>
                        </ol>
                        <p>Data entities can be requested using their name and and an extension.</p>
                        <p>On request, Datapedia will check if your data exists in the given format. If not, it will check if it exists in other supported formats, convert the foreign format, cache the result and return it. If it still not exists, then you will receive an error message with a HTTP 404 code.
                        <p>If the extension is ommited, an friendly HTML template will presented.</p>
                        <p>Yet, only JSON is supported.</p>           
                    </div>
                </section>
                
              
                
                
                <section class="row">
                    <div class="col-xs-12">
                    
                        <h2>End points</h2>
                        <table class="table">
                            <tr>
                                <td><code>data/{name}.{ext}</code></td>
                                <td>GET, POST or PUT</td>
                                <td><code>{ext}</code> is one of the supported format</td>
                            </tr>
                            <tr>
                                <td><code>data/{name}.{ext}/{time}</code></td>
                                <td>GET</td>
                                <td><code>{time}</code> is the number of second since january 19 1970</td>
                            <tr>
                                <td><code>evolution/{name}.{ext}</code></td>
                                <td>GET</td>
                                <td><code>{time}</code> is the number of second since january 19 1970</td>
                            </tr>
                        </table>
                    </div>
                </section>
                
                <section class="row">
                
                    <div class="col-xs-6">
                        
                        <h2>Data structure</h2>
                        
                        <p>This is how data are stored internally</p>
                        
                        <pre>{{ structure | pprint }}</pre>
                        
                        <p>In JSON, it looks like</p>
                        
                        <pre>{{Â example | tojson }}</pre>
                        
                        <p>In XML</p>
                        <pre></pre>
                        
                        <p>In YAML</p>
                        <pre></pre>
                    
                    </div>
                    
                    <div class="col-xs-6">
                    
                        <h2>Data validation</h2>
                        
                        <h3>Using GET</h3>
                        <ul>
                            <li>HTTP code is 200</li>
                            <li>Content-Length header is respected</li>
                            <li>Content-MD5 header is respected</li>
                        </ul>
                       
                        <h3>Using POST or PUT</h3>
                        <ul>
                            {% for field in structure %}
                                <li><code>{{ field }}</code> isin't a jerk</li>
                            {% endfor %}
                        </ul>
                        
                        <h3>Data regression testing</h3>
                        <p>Data containing regression (changes that breaks softwares), will not be accepted. The data will be analyzed to ensure that it is retro-compatible with the current existing version.</p>
                        <p>For instance</p>

                        <ul> 
                            <li>list can have new entries</li>
                            <li>dictionary can have new keys</li>
                            <li>a string value could not become an integer</li>
                        </ul>

                        <p>A recursive algorithm walk into the data structure and ensure that types are preserved.<p>

                    </div>
                </section>

                <section>
                    <div class="col-xs-12">
                        <h2></h2>
                        <p>This is an ajax example written in jQuery<p>
                        
                        <pre>{{ jquery_example }}</pre>
                        
                        <noscript><div class="alert">You must enable Javascript to see this example.</div></noscript>
                        
                        <div id="ajax-example"></div>
                    </div>
                </section>
            {% endblock %}
        </div>
        <footer>
            {% block footer %}
                <div class="container">
                    <p class="text-center">Datapedia source code is providen under GPLv3 here on <a href="https://github.com/arteymix/datapedia">GitHub</a>.</p>
                    <p class="text-center"><a href="{{ url_for('about') }}">About Datapedia</a></p>
                </div>
            {% endblock %}
        </footer>
        {%block javascript %}
            <script type="application/javascript" src="{{ url_for('static', filename= 'js/ajax-example') }}"></script>
        {% endblock %}
    </body>
</html>
